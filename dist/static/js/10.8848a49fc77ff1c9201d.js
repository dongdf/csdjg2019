webpackJsonp([10],{AzIw:function(t,s){},Qi9M:function(t,s){},W8oo:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={name:"buy-miyao",data:function(){return{message:null,name:null,sendcrm:!1,keyRules:"",formC:{keyNumb:"1"},iswechatBuy:!1,ruleInline:{keyNumb:[{required:!0,trigger:"blur"}]}}},mounted:function(){this.ruleInline.keyNumb[0].validator=function(t,s,e){return s.trim()?/^[1-9]+[0-9]*]*$/.test(s)?void e():e(new Error("请输入正整数")):e(new Error("请输入购买数量"))}},methods:{bkey:function(){var t=this;this.$refs.buyKeyForm.validate(function(s){s?(t.$el.parentNode.removeChild(t.$el),"function"==typeof t.onOk&&t.onOk(t)):t.$Message.error("提交失败，请查看原因!")})},cancle:function(){this.$el.parentNode.removeChild(this.$el)},ok:function(){this.$el.parentNode.removeChild(this.$el),"function"==typeof this.onOk&&this.onOk(this,this.formC.keyNumb)}}},i={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"ivu-modal-mask"}),t._v(" "),e("div",{staticClass:"ivu-modal-wrap"},[e("div",{staticClass:"ivu-modal",staticStyle:{width:"420px"}},[e("div",{staticClass:"ivu-modal-content"},[e("a",{staticClass:"ivu-modal-close"},[e("i",{staticClass:"ivu-icon ivu-icon-ios-close",staticStyle:{"font-size":"30px",color:"#666"},on:{click:t.close}})]),t._v(" "),e("div",{staticClass:"ivu-modal-header"},[e("div",{staticClass:"ivu-modal-header-inner"},[e("Icon",{attrs:{color:"#08F",type:"md-key"}}),t._v("购买秘钥")],1)]),t._v(" "),e("div",{staticClass:"ivu-modal-body"},[e("div",[e("h3",[t._v("套餐购买")]),t._v(" "),e("Row",[e("Col",{attrs:{span:"8"}},[e("div",{staticClass:"tcitem"},[e("h3",[t._v("100秘钥")]),e("p",[t._v("售价￥99")]),e("span",{staticClass:"jiaobiao"},[t._v("推荐")])])]),t._v(" "),e("Col",{attrs:{span:"8"}},[e("div",{staticClass:"tcitem"},[e("h3",[t._v("500秘钥")]),e("p",[t._v("售价￥490")])])]),t._v(" "),e("Col",{attrs:{span:"8"}},[e("div",{staticClass:"tcitem"},[e("h3",[t._v("1000秘钥")]),e("p",[t._v("售价￥980")])])])],1)],1),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"buyctn"},[e("Form",{ref:"buyKeyForm",attrs:{model:t.formC,rules:t.ruleInline}},[e("FormItem",{attrs:{label:"购买数量",prop:"keyNumb"}},[e("Input",{attrs:{type:"text",placeholder:"请输入"},model:{value:t.formC.keyNumb,callback:function(s){t.$set(t.formC,"keyNumb",s)},expression:"formC.keyNumb"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[e("Icon",{attrs:{type:"md-key"}})],1),t._v(" "),e("span",{attrs:{slot:"append"},slot:"append"},[t._v("个")])])],1)],1),t._v(" "),e("div",{staticClass:"heji"},[t._v("合计:"),e("b",[t._v(t._s(t.formC.keyNumb)+"元")])]),t._v(" "),e("div",{staticClass:"buyden"},[e("Button",{attrs:{type:"success",long:"",icon:"md-cart",size:"large"},nativeOn:{click:function(s){t.bkey()}}},[t._v("微信支付")])],1)],1)])])])])])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",[s("h3",[this._v("单独购买")])])}]};var n=e("VU/8")(a,i,!1,function(t){e("j/HX")},"data-v-32dcb0ed",null).exports,o={name:"buy-miyao",data:function(){return{orderNo:"",timer:null}},mounted:function(){var t=this,s=this;this.timer=setInterval(function(){t.$http.post("financial/orderService/payOrderResult",{subData:t.orderNo}).then(function(t){1==t.data.code?(clearInterval(s.timer),s.ok()):3!=t.data.code&&4!=t.data.code||location.reload()})},1e3)},methods:{ok:function(){this.$el.parentNode.removeChild(this.$el),"function"==typeof this.onOk&&this.onOk(this)},close2:function(){this.$el.parentNode.removeChild(this.$el),clearInterval(this.timer)}}},r={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",[s("div",{staticClass:"ivu-modal-mask"}),this._v(" "),s("div",{staticClass:"ivu-modal-wrap"},[s("div",{staticClass:"ivu-modal",staticStyle:{width:"420px"}},[s("div",{staticClass:"ivu-modal-content"},[s("a",{staticClass:"ivu-modal-close"},[s("i",{staticClass:"ivu-icon ivu-icon-ios-close",staticStyle:{"font-size":"30px",color:"#666"},on:{click:this.close2}})]),this._v(" "),s("div",{staticClass:"ivu-modal-header"},[s("div",{staticClass:"ivu-modal-header-inner"},[s("Icon",{attrs:{color:"#08F",type:"md-key"}}),this._v("请使用微信扫码进行支付")],1)]),this._v(" "),s("div",{staticClass:"ivu-modal-body"},[s("img",{staticStyle:{width:"100%"},attrs:{src:this.message}})])])])])])},staticRenderFns:[]};var c=e("VU/8")(o,r,!1,function(t){e("Qi9M")},"data-v-2080897b",null).exports,l=e("cPLa"),v={data:function(){return{active:1,rtotal:0,psize:100,pnumb:1,odrList:[],userinfo:{},ysyDou:""}},components:{buyMiyao:n,buyMa:c,no:l.a},mounted:function(){this.getuser(),this.getused()},methods:{getuser:function(){var t=this;this.$http.post("financial/userService/getCurUser").then(function(s){t.userinfo=s.data})},change:function(t){console.log(t),this.pnumb=t,this.getCompany()},changTb:function(t){this.active=t,this.pnumb=1,2==this.active?this.getOrder():this.getused()},buyMy:function(){var t=this;this.$mymsg(n,{data:{message:"you click me btn1"},methods:{onOk:function(){t.buyDou(this.formC.keyNumb)}}})},buyDou:function(t){var s=this;this.$http.post("financial/orderService/newOrder",{subData:t}).then(function(t){1!=t.data.code?s.$Message.error(t.data.msg):s.showWechatMa(t.data.data.codeURL,t.data.data.orderNo)},function(t){alert(t.data.message)})},getused:function(){var t=this;this.$http.post("financial/userService/useKeytList",{subData:{pageNum:this.pnumb,pageSize:this.psize}}).then(function(s){t.odrList=s.data.data.list,t.rtotal=s.data.data.total,t.ysyDou=s.data.data.total})},getOrder:function(){var t=this;this.$http.post("financial/orderService/list",{subData:{pageNum:this.pnumb,pageSize:this.psize}}).then(function(s){t.odrList=s.data.data.list,t.rtotal=s.data.data.total})},showWechatMa:function(t,s){var e=this;this.$mymsg(c,{data:{message:t,orderNo:s},methods:{onOk:function(){e.getuser(),2==e.active&&(e.getOrder(),e.getuser())}}})}}},u={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("Row",{staticStyle:{"border-bottom":"2px solid #EEE","padding-bottom":"10px"}},[e("Col",{attrs:{span:"18"}},[e("div",{staticClass:"cpageTitle"},[e("Icon",{attrs:{size:"20",type:"md-key"}}),e("span",[t._v("秘钥管理")])],1)]),t._v(" "),e("Col",{staticStyle:{"text-align":"right"},attrs:{span:"6"}})],1),t._v(" "),e("br"),t._v(" "),e("Alert",{attrs:{"show-icon":""}},[t._v("\n      尊敬的"+t._s(t.userinfo.mobile)+"用户您好\n      "),e("Icon",{attrs:{slot:"icon",type:"ios-contact",size:"40"},slot:"icon"}),t._v(" "),e("template",{slot:"desc"},[e("div",{staticClass:"miyaoPro"},[t._v("\n          当前秘钥："),e("b",[t._v(t._s(t.userinfo.keyt_num))]),t._v("个   "),e("span",[t._v("已使用："),e("b",[t._v(t._s(t.ysyDou))]),t._v("个")]),t._v(" "),e("div",{staticClass:"buy"},[e("Button",{attrs:{size:"large",type:"success"},nativeOn:{click:function(s){t.buyMy()}}},[t._v("购买秘钥")])],1)])])],2),t._v(" "),e("br"),t._v(" "),e("center",[e("ButtonGroup",[e("i-button",{staticClass:"ivu-btn",class:1==t.active?"ivu-btn-primary":"",nativeOn:{click:function(s){t.changTb(1)}}},[e("Icon",{attrs:{type:"md-time"}}),t._v("\n        使用记录\n      ")],1),t._v(" "),e("Button",{staticClass:"ivu-btn",class:2==t.active?"ivu-btn-primary":"",nativeOn:{click:function(s){t.changTb(2)}}},[t._v("\n        购买记录\n        "),e("Icon",{attrs:{type:"ios-basket"}})],1)],1)],1),t._v(" "),e("br"),t._v(" "),1==t.active?e("div",[e("Row",{staticClass:"rheader"},[e("Col",{staticClass:"tleft",attrs:{span:"8"}},[t._v("公司名称")]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v("使用时间")]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v("数量")])],1),t._v(" "),t._l(t.odrList,function(s,a){return e("Row",{key:a,staticClass:"rerow"},[e("Col",{staticClass:"tleft",attrs:{span:"8"}},[e("Icon",{staticStyle:{opacity:".6",position:"relative",top:"0px"},attrs:{size:"15",type:"md-briefcase"}}),t._v(t._s(s.companyName))],1),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v(t._s(t._f("timeNumb")(s.useTime,"yyyy-MM-dd hh:mm")))]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[e("span",[t._v("-"+t._s(s.keytNum))])])],1)})],2):t._e(),t._v(" "),2==t.active?e("div",[e("Row",{staticClass:"rheader"},[e("Col",{staticClass:"tleft",attrs:{span:"8"}},[t._v("购买数量")]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v("购买时间")]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v("金额")])],1),t._v(" "),t._l(t.odrList,function(s,a){return e("Row",{key:a,staticClass:"rerow"},[e("Col",{staticClass:"tleft",attrs:{span:"8"}},[e("Icon",{staticStyle:{opacity:".6",position:"relative",top:"0px"},attrs:{size:"15",type:"md-key"}}),t._v(t._s(s.num)+"个")],1),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[t._v(t._s(t._f("timeNumb")(s.payTime,"yyyy-MM-dd hh:mm")))]),t._v(" "),e("Col",{staticClass:"tcenter",attrs:{span:"8"}},[e("span",[t._v("￥"+t._s(s.amount))])])],1)})],2):t._e(),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.odrList.length>0,expression:"odrList.length > 0"}],staticClass:"pager"},[e("Page",{attrs:{total:t.rtotal,current:t.pnumb,"page-size":t.psize,"show-total":""},on:{"on-change":t.change}})],1),t._v(" "),e("no",{directives:[{name:"show",rawName:"v-show",value:0==t.odrList.length,expression:"odrList.length == 0"}],attrs:{tipText:"暂无记录"}})],1)},staticRenderFns:[]};var d=e("VU/8")(v,u,!1,function(t){e("AzIw")},"data-v-b116dd3e",null);s.default=d.exports},"j/HX":function(t,s){}});